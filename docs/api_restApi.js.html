<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>api/restApi.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-hooks_api.html">hooks/api</a></li></ul><h3>Global</h3><ul><li><a href="global.html#API">API</a></li><li><a href="global.html#ActionAPI">ActionAPI</a></li><li><a href="global.html#App">App</a></li><li><a href="global.html#AuthAPI">AuthAPI</a></li><li><a href="global.html#AuthProvider">AuthProvider</a></li><li><a href="global.html#Footer">Footer</a></li><li><a href="global.html#GaugeBrightness">GaugeBrightness</a></li><li><a href="global.html#GaugeCard">GaugeCard</a></li><li><a href="global.html#GaugeHumidity">GaugeHumidity</a></li><li><a href="global.html#GaugeIdealRadial">GaugeIdealRadial</a></li><li><a href="global.html#GaugeMultiZoneRadial">GaugeMultiZoneRadial</a></li><li><a href="global.html#GaugeTemperature">GaugeTemperature</a></li><li><a href="global.html#GreenhouseAPI">GreenhouseAPI</a></li><li><a href="global.html#GreenhouseCard">GreenhouseCard</a></li><li><a href="global.html#GreenhouseForm">GreenhouseForm</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#HealthAPI">HealthAPI</a></li><li><a href="global.html#NotificationAPI">NotificationAPI</a></li><li><a href="global.html#PresetAPI">PresetAPI</a></li><li><a href="global.html#RequireAuth">RequireAuth</a></li><li><a href="global.html#SensorAPI">SensorAPI</a></li><li><a href="global.html#UserAPI">UserAPI</a></li><li><a href="global.html#authPath">authPath</a></li><li><a href="global.html#checkAuth">checkAuth</a></li><li><a href="global.html#delay">delay</a></li><li><a href="global.html#failedQueue">failedQueue</a></li><li><a href="global.html#getBrowserSubscription">getBrowserSubscription</a></li><li><a href="global.html#getPermissionStatus">getPermissionStatus</a></li><li><a href="global.html#isPushSupported">isPushSupported</a></li><li><a href="global.html#isRefreshing">isRefreshing</a></li><li><a href="global.html#normalizeSubscription">normalizeSubscription</a></li><li><a href="global.html#processQueue">processQueue</a></li><li><a href="global.html#resolveOffset">resolveOffset</a></li><li><a href="global.html#root">root</a></li><li><a href="global.html#router">router</a></li><li><a href="global.html#routes">routes</a></li><li><a href="global.html#secureChildren">secureChildren</a></li><li><a href="global.html#showPushPermissionPrompt">showPushPermissionPrompt</a></li><li><a href="global.html#urlBase64ToUint8Array">urlBase64ToUint8Array</a></li><li><a href="global.html#useAction">useAction</a></li><li><a href="global.html#useApiUtils">useApiUtils</a></li><li><a href="global.html#useAuth">useAuth</a></li><li><a href="global.html#useCSSVar">useCSSVar</a></li><li><a href="global.html#useCommonGaugeTheme">useCommonGaugeTheme</a></li><li><a href="global.html#useGreenhouse">useGreenhouse</a></li><li><a href="global.html#useHealth">useHealth</a></li><li><a href="global.html#useNotification">useNotification</a></li><li><a href="global.html#usePreset">usePreset</a></li><li><a href="global.html#usePush">usePush</a></li><li><a href="global.html#useUser">useUser</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">api/restApi.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * SmartGrow REST API layer.
 *
 * This module defines an interface to all HTTP endpoints exposed by the SmartGrow backend.
 * It uses a configured Axios instance to ensure consistent headers, authentication, and refresh handling.
 *
 * This layer is grouped by logical backend services:
 * - AuthAPI: Authentication and token issuance
 * - ActionAPI: Historical user-triggered actions
 * - SensorAPI: Environmental sensor data
 * - PresetAPI: CRUD operations for plant growth presets
 * - HealthAPI: System status diagnostics
 *
 * All requests are authenticated unless otherwise noted.
 * @author Taggerkov,Alexa Kelemen
 * @version 2.0.0
 * @since 0.0.1
 */
import API, {
    authPath,
    userPath,
    greenhousePath,
    sensorPath,
    actionPath,
    presetPath,
    notificationPath,
    healthPath
} from './axiosConfig'
/**
 * @typedef {import('@/api/dtoTypes').LoginCredentials}
 * @typedef {import('@/api/dtoTypes').RegisterCredentials}
 * @typedef {import('@/api/dtoTypes').AuthResponse}
 * @typedef {import('@/api/dtoTypes').UserProfileDTO}
 * @typedef {import('@/api/dtoTypes').PastSensorReadingRequestDTO}
 * @typedef {import('@/api/dtoTypes').PastSensorReadingResultDTO}
 * @typedef {import('@/api/dtoTypes').CurrentSensorReadingResultDTO}
 * @typedef {import('@/api/dtoTypes').SensorThresholdDTO}
 * @typedef {import('@/api/dtoTypes').ActionQueryDTO}
 * @typedef {import('@/api/dtoTypes').ActionResultDTO}
 * @typedef {import('@/api/dtoTypes').GreenhouseStatusDTO}
 * @typedef {import('@/api/dtoTypes').GreenhousePairDTO}
 * @typedef {import('@/api/dtoTypes').GreenhouseRenameDTO}
 * @typedef {import('@/api/dtoTypes').NotificationQueryDTO}
 * @typedef {import('@/api/dtoTypes').NotificationResultDTO}
 * @typedef {import('@/api/dtoTypes').RawHealthResponse}
 */

/**
 * Authentication API for user login and registration.
 *
 * This module interacts with the backend `AuthController`, mapping to the following DTOs:
 * - Request: `UserDto` (for login), `RegisterRequestDto` (for registration)
 * - Response: `AuthResponseDto`
 * @author Taggerkov
 */
const AuthAPI = {
    /**
     * Logs in an existing user.
     * @param {LoginCredentials} credentials - UserDto.&lt;br>
     * Contains email and password.
     * @returns {Promise&lt;AuthResponse>} AuthResponseDto.&lt;br>
     * Contains tokens and confirmed email.
     */
    login: credentials => API.post(`${authPath}/login`, credentials).then(res => res.data),
    /**
     * Registers a new user.
     * @param {RegisterCredentials} credentials - RegisterRequestDto.&lt;br>
     * Contains email, password, and confirmation.
     * @returns {Promise&lt;AuthResponse>} AuthResponseDto.&lt;br>
     * Contains tokens and confirmed email.
     */
    register: credentials => API.post(`${authPath}/register`, credentials).then(res => res.data),

    /**
     * Requests a new access token using a refresh token.
     * @param {string} refreshToken - The existing refresh token.
     * @returns {Promise&lt;RefreshResponse>} RefreshResponse.&lt;br>
     * Contains both new tokens.
     */
    refresh: (refreshToken) => API.post(`${authPath}/refresh`, refreshToken, {headers: {'Content-Type': 'application/json'}}).then(res => res.data)
};

/**
 * User API for account-level operations on the authenticated user.
 *
 * This module interacts with the backend `UserController`, scoped to the currently authenticated user.
 * - No request DTO is used
 * - Response: `string` confirmation message
 * @author Taggerkov
 */
const UserAPI = {
    /**
     * Deletes the currently authenticated user's account.
     * @param {string} password - User's password for confirmation.
     * @returns {Promise&lt;string>} Success message
     */
    deleteUser: (password) => API.delete(`${userPath}`, {params: {password}}).then(res => res.data)
};

/**
 * Greenhouse API for managing user-linked greenhouse devices.
 *
 * This module interacts with the backend `GreenhouseController`, mapping to the following DTOs:
 * - Request: `GreenhousePairDTO`, `GreenhouseRenameDTO`
 * - Response: `string` confirmation messages
 * @author Taggerkov, Alexa Kelemen
 */
const GreenhouseAPI = {
    /**
     * Pairs a greenhouse device with the authenticated user.
     * @param {GreenhousePairDTO} payload - GreenhousePairDto.&lt;br>
     * Contains MAC address and greenhouse name.
     * @returns {Promise&lt;string>} Confirmation message.
     * @author Taggerkov
     */
    pair: (payload) => API.post(`${greenhousePath}/pair`, payload).then(res => res.data),

    /**
     * Unpairs a greenhouse by ID from the authenticated user.
     * @param {number} id - ID of the greenhouse to unpair.
     * @returns {Promise&lt;string>} Confirmation message.
     * @author Taggerkov
     */
    unpair: (id) => API.post(`${greenhousePath}/unpair/${id}`, id).then(res => res.data),

    /**
     * Renames a greenhouse associated with the authenticated user.
     * @param {GreenhouseRenameDTO} payload - GreenhouseRenameDTO&lt;br>
     * Contains new name and greenhouse ID.
     * @returns {Promise&lt;string>} Confirmation message.
     */

    rename: (payload) => API.put(`${greenhousePath}/rename/${payload.id}`, payload).then(res => res.data),

    /**
     * Assigns a preset to a greenhouse.
     * @param {number} greenhouseId - Greenhouse ID.
     * @param {number} presetId - ID of the preset to assign.
     * @returns {Promise&lt;string>} Confirmation message.
     */
    assignPreset: (greenhouseId, presetId) =>
        API.put(`${greenhousePath}/preset/${greenhouseId}`, presetId, {
            headers: {
                'Content-Type': 'application/json'
            }
        }).then(res => res.data),

    /**
     * Sends a configuration POST request for a greenhouse.
     *
     * @param {number} greenhouseId - The greenhouse ID (used in query).
     * @param {number|string} id - The config target ID (used in path).
     * @param {{ type: string, method: string }} payload - Configuration data.
     * @returns {Promise&lt;string>} Confirmation message.
     */
    configure: (greenhouseId, id, payload) => API.put(`${greenhousePath}/configure/${id}`, payload, {params: {greenhouseId}}),

/**
   * Fetches all greenhouses associated with the authenticated user.
   * @returns {Promise&lt;GreenhouseDTO[]>} Array of greenhouse objects.
   */
     getAll: () =>
        API.get(`${greenhousePath}`).then((res) => res.data),
  

  /**
   * Triggers a prediction for a specific greenhouse.
   * @param {number} greenhouseId
   * @returns {Promise&lt;string>} Prediction result or confirmation.
   */
  predict: (greenhouseId) =>
    API.post(`${greenhousePath}/predict/${greenhouseId}`).then(res => res.data),
}

/**
 * Sensor API for accessing environmental sensor data.
 *
 * This module interacts with the backend `SensorReadingController`, mapping to the following DTOs:
 * - Request: `PastSensorReadingRequestDTO` (for historical queries)
 * - Response: `CurrentSensorReadingResultDTO[]`, `PastSensorReadingResultDTO[]`
 * @author Taggerkov
 */
const SensorAPI = {
    /**
     * Gets current sensor readings.
     * @param {number} greenhouseId - Greenhouse ID.
     * @returns {Promise&lt;CurrentSensorReadingResultDTO[]>} CurrentSensorReadingResultDTO.&lt;br>
     * Contains id, type, unit, timestamp, and values.
     */
    getCurrentReadings: (greenhouseId) => API.get(`${sensorPath}/${greenhouseId}/current-sensor-readings/`).then(res => res.data),

    /**
     * Gets historical sensor data with optional filters.
     * @param {number} greenhouseId - Greenhouse ID.
     * @param {PastSensorReadingRequestDTO} [filters={}] - PastSensorReadingRequestDTO.&lt;br>
     * Contains after/before dates and reading type.
     * @returns {Promise&lt;PastSensorReadingResultDTO[]>} PastSensorReadingResultDTO.&lt;br>
     * Contains id, type, value, unit, and timestamp.
     */
    getPastReadings: (greenhouseId, filters = {}) => API.get(`${sensorPath}/${greenhouseId}/past-sensor-readings/`, {params: filters}).then(res => res.data)
};

/**
 * Action API for querying historical greenhouse actions.
 *
 * This module interacts with the backend `ActionController`, mapping to the following DTOs:
 * - Request: `ActionQueryDTO`
 * - Response: `ActionResultDTO[]`
 * @author Taggerkov, Alexa Kelemen
 */
const ActionAPI = {
    /**
     * Retrieves past actions for a greenhouse in a date range.
     * @param {number} greenhouseId - Greenhouse ID.
     * @param {ActionQueryDTO} filters - ActionQueryDTO.&lt;br>
     * Contains start and end timestamps.
     * @returns {Promise&lt;ActionResultDTO[]>} ActionResultDTO.&lt;br>
     * Contains type, status, and timestamp.
     * @author Taggerkov
     */
    getPastActions: (greenhouseId, filters) => API.post(`${actionPath}/${greenhouseId}/past-actions`, filters).then(res => res.data),

    /**
     * Triggers a new action on the specified greenhouse.
     * @param {number} greenhouseId - Greenhouse ID.
     * @param {string} actionType - Action name (e.g., "Irrigation", "Ventilation").
     * @returns {Promise&lt;string>} Success message or result from server.
     */
    triggerAction: (greenhouseId, actionType) => API.post(`${actionPath}/${greenhouseId}/triggerAction`, actionType, {headers: {"Content-Type": "application/json"}}).then(res => res.data)
};

/**
 * Preset API for managing user-defined plant growth configurations.
 *
 * This module interacts with the backend `PresetController`, mapping to the following DTOs:
 * - Request: `Preset` (used for creation and update)
 * - Response: `Preset` (on fetch and create)
 * @author Taggerkov, Alexa Kelemen
 */
const PresetAPI = {
    /**
     * Creates a new preset with specified parameters.
     *
     * @param {CreatePresetDTO} preset - Preset DTO with user-defined environmental preferences.
     * @returns {Promise&lt;Preset>} The newly created preset.
     * @author Taggerkov
     */
    createPreset: (preset) => API.post(`${presetPath}`, preset).then(res => res.data),

    /**
     * Fetches a preset by unique identifier.
     *
     * @param {number} id - Preset ID.
     * @returns {Promise&lt;Preset>} The preset, if found.
     * @author Taggerkov
     */
    getPreset: (id) => API.get(`${presetPath}/${id}`).then(res => res.data),

    /**
     * Updates a preset by ID with new parameters.
     *
     * @param {number} id - Preset ID.
     * @param {UpdatePresetDTO} preset - Full preset object to replace existing.
     * @returns {Promise&lt;number>} HTTP status code from server.
     * @author Taggerkov
     */
    updatePreset: (id, preset) => API.put(`${presetPath}/${id}`, preset).then(res => res.status),

    /**
     * Permanently deletes a preset by ID.
     *
     * @param {number} id - Preset ID.
     * @returns {Promise&lt;number>} HTTP status code from server.
     * @author Taggerkov
     */
    deletePreset: (id) => API.delete(`${presetPath}/${id}`).then(res => res.status),

    /**
     * Gets all presets.
     * @returns {Promise&lt;Preset[]>}
     */
    getAllPresets: () => API.get(`${presetPath}/all`).then(res => res.data)
};

/**
 * Health API for checking backend service availability.
 *
 * This module interacts with the backend `HealthCheckController`, returning a simple service status response.
 * - Response: `{ status: string }`
 * @author Taggerkov
 */
const HealthAPI = {
    /**
     * Verifies whether the backend service is online.
     *
     * @returns {Promise&lt;RawHealthResponse>} A status object, e.g. { status: "Healthy" }.
     */
    getStatus: () => API.get(`${healthPath}`).then(res => res.data)
};

/**
 * Notification API for fetching greenhouse alerts.
 *
 * This module interacts with the backend `NotificationController`, which provides
 * time-bound alert messages such as warnings about environmental conditions.
 * @author Alexa Kelemen, Taggerkov
 */
const NotificationAPI = {
    /**
     * Retrieves the VAPID public key used for client-side push subscription.
     * @returns {Promise&lt;string>} Base64-encoded VAPID public key.
     * @author Taggerkov
     */
    getVapidKey: () => API.get(`${notificationPath}/public-key`).then(res => res.data),

    /**
     * Sends the client-side push subscription to the backend to store it.
     * @param {PushSubscription} subscription - The push subscription object.
     * @returns {Promise&lt;void>}
     * @author Taggerkov
     */
    saveSubscription: (subscription) => API.post(`${notificationPath}/save-subscription`, subscription),

    /**
     * Fetches notifications for a greenhouse within a specific time window.
     *
     * @param {number} greenhouseId - ID of the greenhouse.
     * @param {NotificationQueryDTO} query - Contains `startDate` and `endDate` in ISO format.
     * @returns {Promise&lt;NotificationResultDTO[]>} List of notifications.
     */
    getPastNotifications: (greenhouseId, query) =>
        API.post(`${notificationPath}/${greenhouseId}/past-notifications`, query).then(res => res.data)
};

export {AuthAPI, UserAPI, GreenhouseAPI, SensorAPI, ActionAPI, PresetAPI, NotificationAPI, HealthAPI}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Mon May 26 2025 15:59:56 GMT+0200 (Central European Summer Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
